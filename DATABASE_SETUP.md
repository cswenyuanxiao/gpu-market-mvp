# Database Setup Guide

## é—®é¢˜è¯´æ˜

åœ¨ Render ç­‰å®¹å™¨åŒ–å¹³å°ä¸Šï¼ŒSQLite æ–‡ä»¶æ•°æ®åº“ä¼šåœ¨æ¯æ¬¡éƒ¨ç½²æ—¶è¢«é‡ç½®ï¼Œå¯¼è‡´ç”¨æˆ·æ•°æ®ä¸¢å¤±ã€‚è¿™æ˜¯å› ä¸ºï¼š

1. **å®¹å™¨æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸´æ—¶çš„**ï¼šæ¯æ¬¡éƒ¨ç½²åˆ›å»ºæ–°å®¹å™¨å®ä¾‹
2. **SQLite å­˜å‚¨åœ¨å®¹å™¨å†…**ï¼šæ•°æ®éšå®¹å™¨é”€æ¯è€Œä¸¢å¤±
3. **å…è´¹è®¡åˆ’æ— æŒä¹…åŒ–ç£ç›˜**ï¼šRender çš„æŒä¹…åŒ–ç£ç›˜éœ€è¦ä»˜è´¹è®¡åˆ’

## è§£å†³æ–¹æ¡ˆï¼šPostgreSQL æ•°æ®åº“

æˆ‘ä»¬å·²ç»å®ç°äº†æ•°æ®åº“é€‚é…å™¨ï¼Œæ”¯æŒï¼š

- **å¼€å‘ç¯å¢ƒ**ï¼šSQLiteï¼ˆæœ¬åœ°æ–‡ä»¶ï¼‰
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šPostgreSQLï¼ˆRender æ‰˜ç®¡æ•°æ®åº“ï¼‰

## è®¾ç½®æ­¥éª¤

### 1. åœ¨ Render ä¸Šåˆ›å»º PostgreSQL æ•°æ®åº“

1. ç™»å½• [Render Dashboard](https://dashboard.render.com)
2. ç‚¹å‡» "New +" â†’ "PostgreSQL"
3. é…ç½®æ•°æ®åº“ï¼š
   - **Name**: `gpu-market-db`
   - **Database**: `gpu_market`
   - **User**: `gpu_market_user`
   - **Region**: é€‰æ‹©ä¸ Web Service ç›¸åŒçš„åŒºåŸŸ
   - **Plan**: Freeï¼ˆè¶³å¤Ÿå¼€å‘ä½¿ç”¨ï¼‰

4. åˆ›å»ºåï¼Œå¤åˆ¶ **External Database URL**

### 2. æ›´æ–° Render Web Service é…ç½®

1. è¿›å…¥ä½ çš„ Web Service è®¾ç½®
2. åœ¨ "Environment Variables" ä¸­æ·»åŠ ï¼š
   ```
   DATABASE_URL = [ç²˜è´´ä¸Šé¢å¤åˆ¶çš„æ•°æ®åº“ URL]
   NODE_ENV = production
   ```

### 3. é‡æ–°éƒ¨ç½²

æ¨é€ä»£ç åˆ° GitHubï¼ŒRender ä¼šè‡ªåŠ¨ï¼š

1. å®‰è£… `pg` ä¾èµ–åŒ…
2. æ£€æµ‹åˆ° `DATABASE_URL` ç¯å¢ƒå˜é‡
3. ä½¿ç”¨ PostgreSQL è€Œé SQLite
4. è‡ªåŠ¨åˆ›å»ºæ‰€éœ€çš„è¡¨ç»“æ„

## éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼Œæ£€æŸ¥æ—¥å¿—åº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ˜ Using PostgreSQL database
âœ… Database initialized
```

## æœ¬åœ°å¼€å‘

æœ¬åœ°å¼€å‘æ—¶ï¼Œæ— éœ€ PostgreSQLï¼š

```bash
cd backend
npm install
npm run seed  # ä½¿ç”¨ SQLite
npm start
```

## æ•°æ®è¿ç§»

å¦‚æœéœ€è¦ä»ç°æœ‰ SQLite è¿ç§»æ•°æ®ï¼š

1. **å¯¼å‡ºç°æœ‰æ•°æ®**ï¼ˆæœ¬åœ°ï¼‰ï¼š

```bash
cd backend
node -e "
const Database = require('better-sqlite3');
const db = new Database('data.db');
console.log('Users:', db.prepare('SELECT * FROM users').all());
console.log('GPUs:', db.prepare('SELECT * FROM gpus').all());
"
```

2. **æ‰‹åŠ¨åœ¨ç”Ÿäº§ç¯å¢ƒé‡æ–°åˆ›å»º**ï¼š
   - é‡æ–°æ³¨å†Œç”¨æˆ·è´¦æˆ·
   - é‡æ–°æ·»åŠ å•†å“

## ä¼˜åŠ¿

âœ… **æ•°æ®æŒä¹…åŒ–**ï¼šéƒ¨ç½²åæ•°æ®ä¸å†ä¸¢å¤±  
âœ… **å…è´¹æ–¹æ¡ˆ**ï¼šRender PostgreSQL æœ‰å…è´¹é¢åº¦  
âœ… **è‡ªåŠ¨å¤‡ä»½**ï¼šRender æä¾›æ•°æ®åº“å¤‡ä»½  
âœ… **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒæ›´å¤šå¹¶å‘ç”¨æˆ·  
âœ… **å…¼å®¹æ€§**ï¼šæœ¬åœ°å¼€å‘ä»ä½¿ç”¨ SQLite

## æ•…éšœæ’é™¤

### è¿æ¥å¤±è´¥

- æ£€æŸ¥ `DATABASE_URL` ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
- ç¡®ä¿æ•°æ®åº“å’Œ Web Service åœ¨åŒä¸€åŒºåŸŸ

### è¡¨ä¸å­˜åœ¨

- æ£€æŸ¥éƒ¨ç½²æ—¥å¿—ä¸­çš„ "Database initialized" æ¶ˆæ¯
- æ•°æ®åº“é€‚é…å™¨ä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„è¡¨

### æ€§èƒ½é—®é¢˜

- Render å…è´¹ PostgreSQL æœ‰è¿æ¥æ•°é™åˆ¶
- è€ƒè™‘å‡çº§åˆ°ä»˜è´¹è®¡åˆ’ä»¥è·å¾—æ›´å¥½æ€§èƒ½

## æŠ€æœ¯ç»†èŠ‚

æ•°æ®åº“é€‚é…å™¨ (`backend/database.js`) æä¾›ï¼š

- ç»Ÿä¸€çš„ APIï¼ˆ`query`, `get`, `run`ï¼‰
- è‡ªåŠ¨ SQL æ–¹è¨€è½¬æ¢ï¼ˆSQLite â†” PostgreSQLï¼‰
- è¿æ¥æ± ç®¡ç†
- é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘
