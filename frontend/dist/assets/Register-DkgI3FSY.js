import{j as e}from"./react-query-BGeIQRPr.js";import{r as j,u as y,L as w}from"./react-CTDr35rJ.js";import{a as b}from"./index-DvhTShKy.js";import{F as t}from"./FormField-DCIQlhW3.js";import{u as v,a as N,o as F,s as i}from"./zod-SQF3v9p3.js";import{I as n,B as S}from"./antd-DlFti5e9.js";const E=F({username:i().min(3,"At least 3 characters"),password:i().min(6,"At least 6 characters"),display_name:i().optional()});function P(){var m,l,d;const[h,o]=j.useState(!1),u=y(),{register:r,handleSubmit:f,formState:{errors:a}}=v({resolver:N(E)});async function g(s){var c;o(!0);try{const p=await b("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s.username,password:s.password,display_name:s.display_name||s.username})});if(p.status!==201){const x=((c=await p.json().catch(()=>({})))==null?void 0:c.error)||"Register failed";window.dispatchEvent(new CustomEvent("app-toast",{detail:{text:x,type:"error"}}));return}window.dispatchEvent(new CustomEvent("app-toast",{detail:{text:"Registered, please login",type:"success"}})),u("/login")}finally{o(!1)}}return e.jsxs("div",{className:"form-container",children:[e.jsxs("div",{className:"form-description",children:[e.jsx("h3",{children:"Create Account"}),e.jsx("p",{children:"Join GPU Market to buy and sell graphics cards."})]}),e.jsxs("form",{onSubmit:f(g),className:"modern-form",children:[e.jsxs("div",{className:"form-section",children:[e.jsx("div",{className:"form-field",children:e.jsx(t,{label:"Username",htmlFor:"reg-username",error:(m=a.username)==null?void 0:m.message,children:e.jsx(n,{id:"reg-username",...r("username")})})}),e.jsx("div",{className:"form-field",children:e.jsx(t,{label:"Password",htmlFor:"reg-password",error:(l=a.password)==null?void 0:l.message,children:e.jsx(n.Password,{id:"reg-password",...r("password")})})}),e.jsx("div",{className:"form-field",children:e.jsx(t,{label:"Display Name (Optional)",htmlFor:"reg-display",error:(d=a.display_name)==null?void 0:d.message,children:e.jsx(n,{id:"reg-display",...r("display_name")})})})]}),e.jsx("div",{className:"form-actions",children:e.jsx(S,{type:"primary",htmlType:"submit",loading:h,className:"submit-btn",block:!0,children:"Create Account"})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("p",{children:["Already have an account? ",e.jsx(w,{to:"/login",children:"Login"})]})})]})}export{P as default};
